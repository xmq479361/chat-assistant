# 需求设计文档 - 前端 Vue

## 项目概述

这是一个交互式 AI 对话系统，用户可以输入问题并从 AI 获得回答。用户可以选择不同的对话助手，支持最佳答复、错误答复、复制和重试功能。

## 核心功能

- 支持用户注册和登录功能，支持邮箱和 Google 登录
- 选择不同的对话助手，加载助手信息和历史对话记录
- 支持新增、编辑和删除助手
- 支持助手的描述、默认提示词和单轮最大消息数的配置
- 用户输入问题并发送
- 显示 AI 的回复，并进行最佳答复、错误答复、复制和重试功能

## UI 设计

- 整体采用深色模式样式，背景色为深色，文本颜色为白色。
- 使用 Element Plus 作为 UI 框架，确保界面美观且易于使用。
- 对话助手面板为左右结构，助手列表支持内部滚动，支持收缩-图标模式显示和展开列表模式，默认展开模式。
- 输入框支持动态高度调整，最多可输入 150 行或 5000 字，默认显示 3 行，超过 10 行时支持内部滚动。

## 组件设计

### 1. `AssistantSelector.vue`

- 显示助手列表，支持选择、编辑和删除助手。
- 点击删除后提示是否删除，并提供确认和取消选项。
- 默认使用上次使用对话助手，首次进入下根据用户信息创建默认对话助手。
- 点击编辑时弹出对话助手配置窗口，包含名称、描述、提示词、单轮最大消息数等字段。
- 当对话助手配置被编辑修改、删除时，异步同步服务器。
- 维护助手的状态，确保助手选择和编辑功能正常。
- 支持收缩和展开功能，收缩时显示助手名称首字母或图标。

### 2. `ChatAssistant.vue`

- 显示当前选中助手的信息，根据 `AssistantSelector.vue` 中选中的助手信息进行显示。
- 处理用户输入和发送消息的逻辑。
- 对话助手历史对话缓存 `historyMap`，当用户提问得到回答时更新数据，并同步服务器。
- 对话助手切换时，默认读取对话助手历史对话缓存 `historyMap`，没有则异步查询用户与该对话助手下的历史对话记录，并更新 `historyMap`。最终展示在 `MessageList` 中。
- 从 Firebase Firestore 加载助手配置信息和对话记录。

### 3. `MessageList.vue`

- 显示对话历史记录，支持鼠标悬停时显示操作按钮（“最佳答复”、“错误回复”、“重新加载”、“复制”）。
- 对于用户已提出问题，支持点击编辑和重发功能。
- 对话助手切换时，异步重新查询用户与该对话助手下的历史对话记录。

### 4. `AuthPage.vue`

- 用户登录和注册页面，支持邮箱注册、登录以及 Google 登录功能。
- 进入网站时检测登录状态，未登录用户无法进行对话。
- 登录/注册显示在悬浮块中，默认显示在屏幕中央。

## API 设计

- 使用 DeepSeek API 进行对话处理。
- API 请求通过工具类 `api.js` 进行封装，确保代码的可维护性。
- 使用 Firebase Firestore 进行用户登录和注册，助手配置信息和对话记录的存储。

## 安装步骤

1. 克隆项目
2. 运行 `npm install` 安装依赖
3. 运行 `npm run serve` 启动项目

## 使用方法

在输入框中输入问题并按回车或点击发送按钮，等待 AI 的回复。选择不同的对话助手以获取不同的回答。

## 注意事项

- 确保在 `.env.local` 文件中配置 DeepSeek 的 API 密钥。
- 确保在 `.env.local` 文件中配置 Firebase 的 API 密钥和相关信息。
